---
title: "lab1"
output: html_document
---


```{r setup, include = FALSE}

library("tidyverse")
library("rio")
library("here")
library("knitr")
library("lubridate")
knitr::opts_chunk$set(warning = FALSE,
                      message = FALSE,
                      error = TRUE,
                      fig.width = 6.5,
                      fig.height = 8
                      )
theme_set(theme_minimal(base_size = 8))

```

```{r load_data}
df <- import(here::here("data", "rstats_tweets.rds"),
             setclass = "tbl_df")

head(df)

```


#Commit2
```{r commit2}

subset <- df %>%
  count(screen_name) %>%
  arrange(desc(n)) %>%
  slice (1:25)

#str(subset)

subset %>%
  mutate(screen_name = as.factor(screen_name),
         screen_name = forcats::fct_reorder(screen_name, n)) %>%
  ggplot(aes(x = screen_name, y = n)) + 
  geom_col() +
  coord_flip()

str(subset)

```





```{r commit4 }


subset4 <- df %>% 
  mutate(month = lubridate::round_date(created_at, unit = "month")) %>% 
  filter(month < lubridate::as_datetime("2019-01-01 00:00:00")) %>% 
  count(month) %>% 
  arrange(month)

View(subset4)

subset4 %>% 
ggplot(aes(x = month, y = n)) +
  geom_line() +
  geom_smooth() 
  

```


```{r commit5, fig.width=10, fig.height=10}
subset4 %>% 
ggplot(aes(x = month, y = n)) +
  geom_line(color = "gray40",
            size = 3) +
  geom_smooth(method = "auto",
              se = FALSE,
              color = "magenta",
              size = 3) +
  theme_minimal(base_size = 20) +
  geom_area(alpha = 0.3, fill = "cornflowerblue") +
  labs(x = "Year(data summarized by month)",
       y = "Number of #rstats tweets",
       caption = "Data from Mike Kearny, distributed via #tidytuesday")


```

